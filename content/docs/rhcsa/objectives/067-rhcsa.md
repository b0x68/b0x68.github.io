# Tech Tutorial: Manage Containers - Attaching Persistent Storage

## Introduction

In the world of containerization, managing data persistence is crucial, especially when containers themselves are ephemeral. Attaching persistent storage to a container means that the data survives independently of the container's lifecycle. This tutorial will explore how to attach persistent storage to a container, using Docker as the containerization platform and exploring volume management in detail.

## Step-by-Step Guide

### Prerequisites

- **Docker**: Ensure Docker is installed on your machine. You can download it from [Docker's official website](https://www.docker.com/products/docker-desktop).
- **Command Line Interface**: Basic familiarity with CLI operations is assumed.

### Step 1: Understanding Docker Volumes

Docker volumes are the preferred mechanism for persisting data generated by and used by Docker containers. To manage the lifecycle of this data independently from the lifecycle of the containers that use it, Docker has a powerful volumes subsystem.

### Step 2: Creating a Volume

Before attaching a volume to a container, you must create one. Here's how you do it:

```bash
docker volume create myvolume
```

This command creates a new volume named `myvolume` in Docker's volumes directory. You can inspect the volume using:

```bash
docker volume inspect myvolume
```

### Step 3: Attaching the Volume to a Container

Now that the volume is ready, you can start a container and attach the volume to it. Letâ€™s run a MySQL container as an example:

```bash
docker run -d \
  --name my-mysql \
  -e MYSQL_ROOT_PASSWORD=mypass \
  -v myvolume:/var/lib/mysql \
  mysql:latest
```

In this command:
- `-d` runs the container in detached mode.
- `--name` assigns a name to the container for easier reference.
- `-e` sets environment variables; here, setting the MySQL root password.
- `-v` attaches `myvolume` to `/var/lib/mysql` inside the container.

### Step 4: Verifying the Volume Data Persistence

To test data persistence, you can:
1. Connect to the MySQL container.
2. Create some data.
3. Stop and remove the container.
4. Start a new container with the same volume and check if the data persists.

Here are the commands to do so:

```bash
# Connect to MySQL
docker exec -it my-mysql mysql -uroot -pmypass

# Inside MySQL
CREATE DATABASE testdb;
USE testdb;
CREATE TABLE test (id INT, name VARCHAR(20));
INSERT INTO test VALUES (1, 'Hello, World!');
EXIT;

# Stop and remove the container
docker stop my-mysql
docker rm my-mysql

# Start a new container with the same volume
docker run -d \
  --name my-new-mysql \
  -e MYSQL_ROOT_PASSWORD=mypass \
  -v myvolume:/var/lib/mysql \
  mysql:latest

# Connect to the new MySQL container
docker exec -it my-new-mysql mysql -uroot -pmypass

# Inside MySQL
USE testdb;
SELECT * FROM test;
```

You should see the data `1, 'Hello, World!'` which confirms that the data persisted across containers.

## Conclusion

Attaching persistent storage to containers is an essential skill for managing stateful applications in a containerized environment. By using Docker volumes, you can ensure that your data remains safe even when containers are stopped or removed. This tutorial covered the basics of creating a volume, attaching it to a container, and verifying data persistence, providing a foundation for more advanced container storage management techniques.

Remember, mastering persistent storage in Docker not only helps in managing stateful applications but also in deploying applications in production environments where data durability is crucial.